# 引言

在**第6讲**中，课程构建了一套用于分析二维动力系统的标准“工具箱”。通过计算雅可比矩阵 (Jacobian Matrix) 的两个关键不变量——迹 (Trace, $\tau$) 和行列式 (Determinant, $\Delta$)，不动点附近的线性稳定性分析 (Linear Stability Analysis, LSA) 得以确立。这一分析框架成功地将不动点分类为稳定/不稳定的节点、鞍点或螺旋点，并初步探讨了非线性阻尼如何通过 Hopf 分岔或弛豫振荡机制导致极限环 (Limit Cycles) 的产生。

然而，线性稳定性分析本质上是**局域的 (local)** 。它仅能精确描述系统在不动点无穷小邻域内的行为。对于一个远离不动点的状态，或者当不动点表现为不稳定螺旋点时，线性理论无法预测轨道的最终归宿：**系统是会发散至无穷远，还是会收敛于一个稳定的、自持的周期性轨道？**为了回答这一关于系统**全局动力学 (Global Dynamics)** 的核心问题，必须引入更强有力的拓扑工具。

这节课将首先引入**庞加莱-本迪克松定理 (Poincaré-Bendixson Theorem)** 。作为二维动力系统理论的基石，该定理提供了一个非构造性但极具判别力的准则：在二维相平面的有界区域内，如果不存在稳定不动点，且轨道不发散，则混沌 (Chaos) 被严格排除，系统必然演化出极限环。这为证明周期性振荡的存在性提供了严格的数学基础。

随后，课程将这一理论框架应用于两个具体的复杂系统，展示动力系统理论跨学科的普适性：

1.**生物物理学领域**：分析 **RhoGTPase 循环**，这是调控细胞极性的关键生化网络。分析将展示如何利用物理上的**质量守恒 (Mass Conservation)** 约束，将原本的三维生化反应网络严格降维至二维系统，进而结合庞加莱-本迪克松定理与 Hopf 分岔理论，揭示细胞内蛋白质浓度发生自发振荡的机制。

2.**演化博弈论领域**：探讨 **石头-剪刀-布 (Rock-Paper-Scissors, RPS)** 模型。通过引入**复制子动力学 (Replicator Dynamics)** ，将策略的竞争演化建模为非线性常微分方程组。这呼应了**第2讲**中的博弈论概念，同时展示了生态循环与生化振荡在数学结构上的同构性。

这节课对复制子方程的推导为后续课程奠定了基础。在接下来的**第8讲**中，将引入**李雅普诺夫函数 (Lyapunov Function)** 来深入分析此类系统的全局稳定性与凝聚现象，并最终打破“空间均匀混合”的假设，通过引入**扩散方程 (Diffusion Equation)** ，正式开启对空间延展系统及图灵斑图 (Turing Patterns) 的探索。

# 1. 庞加莱-本迪克松定理 (The Poincaré-Bendixson Theorem)

为了跨越从局域分析到全局动力学的鸿沟，这节课首先引入了庞加莱-本迪克松定理。在上一讲中，通过线性稳定性分析（LSA），我们虽然能够精确判断不动点附近的流场特征（如螺旋点、鞍点），但这种分析在远离不动点时失效。对于一个二维连续动力系统 $\frac{d\vec{x}}{dt} = \vec{F}(\vec{x})$（其中 $\vec{x} = (x, y)$），要回答“系统最终会去向何方”这一全局问题，仅靠雅可比矩阵是不够的。庞加莱-本迪克松定理正是填补这一空白的关键拓扑工具，它为判断非线性振荡（极限环）的存在提供了严格的数学判据。

## 1.1 定理的物理学表述

该定理描述了在二维平面上，受限系统的长期渐近行为。相比于复杂的数学形式，课堂上给出了一个更为直观的、物理学家视角的表述：


![课堂板书截图](../assets/images/07_001_1a7c8dd9-9ee1-4b5a-b28f-23e571e11147.png)

庞加莱-本迪克松定理的表述。它规定了二维有界轨道在长期演化下的两种可能性。

如果对于时间 $t \geq t_0$，系统的一条轨道 (orbit) 满足以下两个几何条件：

1.**有界性 (Boundedness)** ：轨道始终停留在一个有限的、封闭的相空间区域 $R$ 内，不会发散到无穷远（即系统的能量或物质浓度不会无限增加）。

2.**无奇点性 (No Singular Point)** ：轨道在演化过程中不会趋近于任何奇点。这里的“奇点”特指系统的不动点 (Fixed Point) 或稳态 (Steady State)，即 $\vec{F}(\vec{x}) = 0$ 的点。

那么，这条轨道的长期行为$t \to \infty$只有两种可能：

1.**周期轨道**：它本身闭合成为一个周期轨道 (periodic cycle)。

2.**趋近极限环**：它将无限趋近于一个极限环 (limit cycle)。

这意味着，在满足上述条件的二维系统中，系统的最终状态要么是完美的循环，要么是渐近地进入这种循环。

## 1.2 定理的深刻含义：排除混沌

庞加莱-本迪克松定理的重要性不仅在于它肯定了什么（极限环的存在），更在于它否定了什么。它用严格的拓扑语言指出：**二维自治动力系统（Autonomous systems）中不存在混沌 (Chaos)。**

混沌现象（如三维洛伦兹吸引子）的典型特征是轨道虽然有界且不收敛于不动点，但也永不重复（非周期性），呈现出极其复杂的“纠缠”结构。然而，在二维平面相空间中，由于**轨道不能自相交叉**（这是由微分方程解的唯一性决定的），一条被限制在有限区域内的轨道，如果没有不动点可去，就没有足够的空间维度来展现混沌所需的复杂折叠结构。它唯一的选择就是“咬住自己的尾巴”形成闭环，或者无限逼近一个闭环。

因此，对于二维系统而言，只要排除了发散（有界）和静止（不动点），剩下的唯一命运就是**振荡**。

## 1.3 定理的实践策略：“陷阱区域”法

在实际的生物物理建模中，直接解出非线性方程的极限环解析解通常是不可能的。庞加莱-本迪克松定理提供了一种强大的**非构造性（non-constructive）证明策略**，通过几何构建即可证明振荡的存在。

该策略包含两个核心步骤：

1.**第一步：构建“陷阱区域” (Trapping Region)**

首先需要在相空间中划定一个封闭区域 $R$。这通常基于物理约束，例如物质浓度非负（$x, y \ge 0$）以及质量守恒或最大承载量导致的上限。关键在于证明在区域 $R$ 的边界上，向量场 $\vec{F}(\vec{x})$ 的指向是指向区域内部或沿边界切向的。这确保了任何进入该区域的轨道都无法逃逸，从而满足定理的“有界性”条件。

2.**第二步：排除稳定不动点**

接下来，需要检查这个“陷阱区域” $R$ 内部包含的所有不动点。利用上一节课建立的线性稳定性分析工具（雅可比矩阵的迹 $\tau$ 和行列式 $\Delta$），分析这些不动点的稳定性。

如果在陷阱区域 $R$ 内存在唯一的一个不动点，并且通过计算证实该不动点是**不稳定**的（例如，一个不稳定螺旋点，满足 $\Delta > 0, \tau > 0$），那么根据庞加莱-本迪克松定理：

* 轨道被限制在 $R$ 内（无法逃逸到无穷远）。

* 轨道被不稳定的不动点“排斥”（无法停留在静止状态）。

* **推论**：轨道必须收敛于 $R$ 内部的一个极限环。

这种方法将“证明存在非线性振荡”这一复杂的全局问题，转化为了两个相对简单的步骤：验证物理边界（有界性）和计算局部导数（不稳定性）。这正是后续分析 RhoGTPase 振荡器的核心逻辑。

# 2. 生物物理振荡器：RhoGTPase 循环

为了演示庞加莱-本迪克松定理的实际应用，这小节引入了一个具体的生物物理系统——**RhoGTPase 循环**。这是一个在细胞生物学中极为核心的生化反应网络，通过非线性的正反馈与负反馈机制，能够在细胞膜上产生自发的时空振荡。本节将从生物学背景出发，逐步构建反应动力学模型，并将其转化为一个三组分的非线性常微分方程组，为后续的降维和相平面分析奠定基础。

## 2.1 生物学背景：细胞内的分子开关

RhoGTPase (如 Rho, Rac, Cdc42) 是一类属于 Ras 超家族的 G 蛋白，它们在细胞内充当关键的“分子开关”，调控着细胞极性、细胞骨架重组以及细胞运动等基本生命活动。

该系统的动力学行为主要由以下两个核心特征决定：

1.**构象状态切换**：RhoGTPase 可以在两种构象之间循环切换：
 
 * **非活性态 (Inactive State)**: 与 GDP 结合 (RhoGDP)。
 
 * **活性态 (Active State)**: 与 GTP 结合 (RhoGTP)。

2.**空间定位循环**：这些蛋白质在细胞的不同空间区域具有不同的分布倾向：
  
  * **细胞质 (Cytosol)**: RhoGTPase 主要以非活性态 (RhoGDP) 存在，并通过与 GDI (Guanine nucleotide dissociation inhibitors) 结合而保持可溶性。
  
 * **细胞膜 (Membrane)**: 活性态 (RhoGTP) 必须锚定在细胞膜上才能发挥功能。

这种在膜与质之间穿梭、并在活性与非活性之间切换的循环过程，构成了细胞内信号转导的时空基础。特别是活性态 RhoGTP 在膜上的局部聚集和振荡（如肌动蛋白波 actin waves），是细胞极性建立和细胞迁移的驱动力。

## 2.2 建立反应模型与非线性反馈

为了捕捉该系统的核心动力学，课程构建了一个包含三个关键组分的最小化模型：

![课堂板书截图](../assets/images/07_002_95c93b8a-0c1c-49a1-b1b0-68583751e8f0.png)

RhoGTPase 循环的反应网络示意图。展示了 Cytosol 与 Membrane 之间的穿梭，以及 GDP 与 GTP 状态的转换。关键的非线性正反馈体现在 $K_{GEP}$ 速率中。

模型定义的三个核心变量如下：

* $M_T$: **膜上**的活性态 (RhoGTP) 浓度。

* $M_D$: **膜上**的非活性态 (RhoGDP) 浓度。

* $C_D$: **细胞质**中的非活性态 (RhoGDP) 浓度。

该生化网络的动力学由两个相互竞争的反馈环路驱动，这是形成振荡的“引擎”：

1.**非线性正反馈 (Non-linear Positive Feedback)**:

膜上的活性态 $M_T$ 能够招募并激活 **GEF** (Guanine nucleotide exchange factors, 鸟嘌呤核苷酸交换因子)。GEF 的功能是催化 $M_D$ 转化为 $M_T$。这就形成了一个自催化过程：$M_T$ 的存在促进了更多 $M_T$ 的产生。

数学上，这种非线性激活速率 $K_{GEP}$ 被建模为 $M_T$ 的函数：

$$
    K_{GEP}(M_T) = K_{basal} + K_{auto} M_T^2
$$

* $K_{basal}$: 基础激活速率，代表自发的背景激活。

* $K_{auto} M_T^2$: **自催化项**。这是一个二阶 Hill 函数形式，表明 $M_T$ 以一种高度非线性的协同方式放大自身的生成速率。正是这个平方项 ($M_T^2$) 引入了系统所需的非线性，是产生不稳定性和振荡的关键。

2.**负反馈 (Negative Feedback)**:

膜上的活性态 $M_T$ 也会被 **GAP** (GTPase-activating proteins, GTP酶激活蛋白) 识别。GAP 促进 GTP 水解，使 $M_T$ 失活并在模型中假设其随即从膜上解离，返回细胞质成为 $C_D$。这一过程由速率常数 $K_{GAP}$ 描述，构成了限制 $M_T$ 无限增长的负反馈回路。

## 2.3 推导三组分动力学方程

基于上述反应网络图，利用**质量作用定律 (Law of Mass Action)** ，可以写出描述三个组分浓度随时间变化的常微分方程组 (ODEs)。

方程组如下：
$$
\begin{cases}
\displaystyle \frac{d}{dt} M_T = -K_{GAP} M_T + K_{GEP}(M_T) M_D \\
\displaystyle \frac{d}{dt} M_D = k_{on} C_D - k_{off} M_D - K_{GEP}(M_T) M_D \\
\displaystyle \frac{d}{dt} C_D = -k_{on} C_D + k_{off} M_D + K_{GAP} M_T
\end{cases}
$$

**方程物理意义详解**:

1.**活性膜蛋白 $M_T$ 的演化**:

$$\frac{d}{dt} M_T = \underbrace{K_{GEP}(M_T) M_D}_{\text{激活 (Activation)}} - \underbrace{K_{GAP} M_T}_{\text{失活并解离 (Inactivation & Extraction)}}$$
 * **激活项**: 来自膜上非活性态 $M_D$ 的转化。由于 $K_{GEP}$ 包含 $M_T^2$，这一项代表了自催化的正反馈增长。
 
 * **消耗项**: 被 GAP 介导失活并从膜上移除。

2.**非活性膜蛋白 $M_D$ 的演化**:

$$\frac{d}{dt} M_D = \underbrace{k_{on} C_D}_{\text{附着 (Attachment)}} - \underbrace{k_{off} M_D}_{\text{自发解离 (Detachment)}} - \underbrace{K_{GEP}(M_T) M_D}_{\text{被消耗转化为 } M_T}$$

这是膜上“底物”库的变化。它从细胞质 ($C_D$) 得到补充，一方面因自发解离而流失，另一方面因转化为活性态 ($M_T$) 而被消耗。

3.**细胞质蛋白 $C_D$ 的演化**:

$$\frac{d}{dt} C_D = - \underbrace{k_{on} C_D}_{\text{附着到膜}} + \underbrace{k_{off} M_D}_{\text{来自 } M_D \text{ 的解离}} + \underbrace{K_{GAP} M_T}_{\text{来自 } M_T \text{ 的失活解离}}$$

细胞质作为蛋白质的“储备库”和“回收站”。它因附着到膜上而减少，同时接收来自膜上两种状态 ($M_T, M_D$) 解离回来的蛋白质。

这一组方程完整描述了系统的动力学。乍看之下，这是一个三维系统，但这将给后续的相平面分析带来困难。下一节将展示如何利用物理上的守恒律将其降维。

# 3. 模型简化与零斜线分析

RhoGTPase 循环原本是一个涉及三个变量 ($M_T, M_D, C_D$) 的复杂动力系统。然而，庞加莱-本迪克松定理的应用严格受限于二维平面。因此，要利用这一强大的拓扑工具，必须首先找到一种物理上合理的方法对系统进行降维。这小节展示了如何利用守恒律这一物理约束，将三维生化网络精确地映射到一个二维动力学平面上，并通过零斜线分析揭示其不动点的几何结构。

## 3.1 关键步骤：基于质量守恒的降维

观察上一小节推导出的三个动力学方程，可以发现一个隐藏的守恒性质。将三个方程相加，所有描述状态转换（如激活、失活、附着、解离）的项都会成对抵消：

$$
\frac{d}{dt} (M_T + M_D + C_D) = 0
$$

这一数学结果对应着深刻的物理意义：**质量守恒 (Mass Conservation)** 。在封闭的细胞系统中，尽管蛋白质在不同状态（活性/非活性）和位置（膜/质）之间不断流转，但其总分子数（或总浓度）$n$ 始终保持不变：
$$
n = M_T + M_D + C_D = \text{const}
$$

这个守恒律构成了一个线性代数约束，将系统原本的三维状态空间压缩到了一个二维平面上。只要确定了膜上的两种状态 $M_T$ 和 $M_D$，细胞质中的浓度 $C_D$ 就被唯一确定为：
$$
C_D = n - M_T - M_D
$$
利用这一关系，可以将 $C_D$ 从方程组中消去，从而将问题严格降维为关于 $(M_T, M_D)$ 的二维系统。

## 3.2 简化的二维动力系统

将 $C_D$ 的表达式代入原方程组，并进行参数简化（无量纲化处理，设 $K_{basal}=1, K_{auto}=1, k_{on}=1, k_{off}=0$ 以聚焦核心机制），最终得到如下二维动力系统：

$$
\begin{cases}
\displaystyle \frac{d}{dt} M_T = -\mu M_T + (1+M_T^2) M_D \\
\displaystyle \frac{d}{dt} M_D = (n - M_T - M_D) - (1+M_T^2) M_D
\end{cases}
$$

系统行为现在完全由两个无量纲控制参数决定：

* **$\mu = K_{GAP} / k_{on}$**: 代表**相对失活速率**。它是膜蛋白失活/解离速率与细胞质蛋白附着速率的比值，衡量了负反馈的强度。

* **$n$**: 代表**总蛋白质量**。它决定了系统的“资源总量”，即有多少蛋白质可供循环使用。

## 3.3 零斜线分析 (Nullcline Analysis)

为了理解这个二维系统的相图结构，首先需要找到**零斜线 (Nullclines)** 。零斜线定义为相平面上使某一变量变化率为零的曲线，不动点即为这些曲线的交点。

令 $\frac{d}{dt} M_T = 0$ 和 $\frac{d}{dt} M_D = 0$，分别得到两条零斜线方程：

1.**$M_T$-零斜线 ($\dot{M}_T = 0$)**:

$$
M_D = \frac{\mu M_T}{1 + M_T^2}
$$

**物理意义**: 这条曲线描述了膜上活性态 $M_T$ 的动态平衡。

  * 分子 $\mu M_T$ 代表线性的失活流出。

  * 分母 $(1+M_T^2)$ 代表非线性的自催化激活流入。

  * 这条曲线呈现典型的 **N形 (或 S形)** 特征：在低 $M_T$ 时线性增长，中间因自催化 ($M_T^2$) 而被压低，高 $M_T$ 时趋于零。这种非线性形状是系统产生多稳态或振荡的几何根源。

2.**$M_D$-零斜线 ($\dot{M}_D = 0$)**:
$$
M_D = \frac{n - M_T}{2 + M_T^2}
$$

**物理意义**: 这条曲线描述了膜上非活性态 $M_D$ 的动态平衡。
  * 分子 $(n - M_T)$ 源于细胞质 $C_D$ 的附着补充，体现了资源限制。
    
  * 分母 $(2 + M_T^2)$ 代表 $M_D$ 因转化为 $M_T$ 或解离而被消耗。



![课堂板书截图](../assets/images/07_003_c6109d6a-9453-4ccb-bd37-74fee4bc76d3.png)

RhoGTPase 系统的相平面分析示意图。横轴为 $M_T$，纵轴为 $M_D$。图中展示了两条零斜线：呈钟形隆起的是 $\dot{M}_T=0$ 零斜线，单调下降的是 $\dot{M}_D=0$ 零斜线。两条曲线的交点（白点）即为系统的不动点。箭头指示了不同区域内的流场方向，暗示了围绕不动点的旋转趋势。

## 3.4 Python 代码实践：绘制零斜线


下面的代码使用 Python 代码板书中的零斜线图像。通过调整参数 $\mu$ 和 $n$，可以观察这两条曲线如何相交，从而确定不动点的位置。

```python
import numpy as np
import matplotlib.pyplot as plt

# Set dark background style to match lecture board
plt.style.use('dark_background')

def plot_rho_nullclines(mu, n, mt_max=6):
    """
    Plots the nullclines for the 2D RhoGTPase model.
    
    Args:
        mu (float): Control parameter (relative inactivation rate).
        n (float): Control parameter (total protein mass).
        mt_max (float): Maximum M_T value for plotting range.
    """
    
    # Create an array for M_T values
    M_T = np.linspace(0, mt_max, 500)
    
    # 1. Calculate M_D for the M_T-nullcline (dM_T/dt = 0)
    # Equation: -mu*M_T + (1+M_T^2)*M_D = 0  =>  M_D = mu*M_T / (1+M_T^2)
    M_D_nullcline_T = (mu * M_T) / (1 + M_T**2)
    
    # 2. Calculate M_D for the M_D-nullcline (dM_D/dt = 0)
    # Equation: (n - M_T - M_D) - (1+M_T^2)*M_D = 0 
    # Derived: M_D = (n - M_T) / (2 + M_T^2)
    M_D_nullcline_D = (n - M_T) / (2 + M_T**2)
    
    # Filter out non-physical negative values (concentration cannot be negative)
    M_D_nullcline_D[M_D_nullcline_D < 0] = np.nan
    
    # Plotting
    plt.figure(figsize=(10, 7))
    
    # Plot M_T-nullcline (Red solid line)
    plt.plot(M_T, M_D_nullcline_T, 'r-', linewidth=2.5, label=r'$\dot{M}_T = 0$ nullcline')
    
    # Plot M_D-nullcline (Cyan dashed line)
    plt.plot(M_T, M_D_nullcline_D, 'c--', linewidth=2.5, label=r'$\dot{M}_D = 0$ nullcline')
    
    # Labeling
    plt.xlabel(r'Active (Membrane) $M_T$', color='white', fontsize=12)
    plt.ylabel(r'Inactive (Membrane) $M_D$', color='white', fontsize=12)
    plt.title(f'RhoGTPase Nullclines ($\mu={mu}, n={n}$)', color='white', fontsize=14)
    
    # Styling
    legend = plt.legend(fontsize=12)
    plt.setp(legend.get_texts(), color='white')
    plt.grid(True, linestyle=':', alpha=0.4, color='gray')
    
    # Set axes limits to focus on the relevant interaction area
    plt.ylim(0, n / 2 + 0.5) 
    plt.xlim(0, mt_max)
    
    # Ensure spines are visible in dark mode
    ax = plt.gca()
    for spine in ax.spines.values():
        spine.set_color('white')
    ax.tick_params(colors='white')

    plt.savefig('rho_nullclines.png', bbox_inches='tight')

# --- Example Usage ---
# Parameters chosen to replicate the crossing shown in the lecture board.
# mu=4.0 creates a pronounced "bell" shape.
# n=10.0 provides enough mass for the intersection to occur on the falling slope.
plot_rho_nullclines(mu=4.0, n=10.0, mt_max=6.0)
```

![运行代码输出](../assets/images/07_004_059881e5-e0fc-4efb-90b8-f1aa7cf5d15b.png)

**红色实线 ($\dot{M}_T=0$)** ：呈现出特征性的钟形隆起。这是由 $M_T^2$ 的非线性正反馈导致的：在低浓度下自催化效应显著，提升了平衡所需的 $M_D$；但在高浓度下，$M_T^2$ 位于分母（饱和效应），导致曲线回落。

**青色虚线 ($\dot{M}_D=0$)** ：呈现单调下降趋势，反映了总资源 $n$ 被 $M_T$ 占用后，留给 $M_D$ 的空间减少。

**交点** ：两条曲线的交点即为系统的不动点。在 $\mu=4.0, n=10.0$ 的参数设定下，交点位于红色曲线的**下降段**（负斜率区域）。后续分析将证明，当交点位于这一特定区域时，不动点往往会因不稳定性（Hopf 分岔）而失稳，从而在相平面上产生围绕该点的极限环振荡。


# 4. 极限环的产生：Hopf 分岔

现在，通过降维得到了二维系统，并利用零斜线找到了不动点。这小节将正式应用庞加莱-本迪克松定理的策略来证明振荡的存在。这分为两步：首先确立系统的有界性，然后证明陷阱区域内的不动点是不稳定的。

## 4.1 构建“陷阱区域”与有界性

庞加莱-本迪克松定理应用的首要前提是轨道的有界性。在这个生物物理模型中，这一条件由物理约束自然满足：

1.**非负性**: 物质浓度不能为负，即 $M_T \ge 0$ 和 $M_D \ge 0$。

2.**质量守恒上限**: 由于 $M_T + M_D + C_D = n$ 且 $C_D \ge 0$，膜上两种状态的总和必须小于等于总质量，即 $M_T + M_D \le n$。

这意味着系统的所有动力学行为都被严格限制在相平面第一象限的一个直角三角形区域内：
$$\{(M_T, M_D) \mid M_T \ge 0, M_D \ge 0, M_T + M_D \le n\}$$
这是一个封闭的有界区域，即定理所需的“陷阱区域”。任何物理上合理的初始条件出发的轨道都无法逃逸出这个三角形。

## 4.2 线性稳定性分析 (Linear Stability Analysis)

既然轨道无法逃逸，要证明极限环的存在，根据庞加莱-本迪克松定理，只需证明该陷阱区域内唯一的**不动点 $(M_T^*, M_D^*)$ 是不稳定的**。

为此，在不动点附近计算雅可比矩阵 (Jacobian Matrix) $\mathcal{J}$，并分析其迹 $\tau$ 和行列式 $\Delta$。

通过对动力学方程 $\dot{M}_T$ 和 $\dot{M}_D$ 分别求偏导，得到雅可比矩阵的解析形式：

$$
\mathcal{J} = \begin{pmatrix}
\frac{\partial \dot{M}_T}{\partial M_T} & \frac{\partial \dot{M}_T}{\partial M_D} \\
\frac{\partial \dot{M}_D}{\partial M_T} & \frac{\partial \dot{M}_D}{\partial M_D}
\end{pmatrix}
= \begin{pmatrix}
-\mu + 2M_T^* M_D^* & 1 + (M_T^*)^2 \\
-1 - 2M_T^* M_D^* & -(2 + (M_T^*)^2)
\end{pmatrix}
$$

基于此矩阵，可以得到两个决定稳定性的关键不变量：

**1.迹 (Trace, $\tau$)：不稳定性判据**

$$
\tau = \text{tr}(\mathcal{J}) = \underbrace{2 M_T^* M_D^*}_{\text{非线性正反馈}} - \underbrace{\left( \mu + 2 + (M_T^*)^2 \right)}_{\text{线性耗散与阻尼}}
$$

* **物理意义**：迹 $\tau$ 反映了系统在不动点附近的体积膨胀率（或振幅增长率）。

    * **正项 ($+2 M_T^* M_D^*$)** ：源自 $K_{GEP}$ 中的 $M_T^2$ 项。它代表了**自催化 (Autocatalysis)** 机制，即活性蛋白促进自身产生的正反馈效应。这是导致系统不稳定的驱动力。
    
    * **负项 ($-\dots$)** ：源自失活速率 $\mu$ 和解离过程。这些项代表了系统的**耗散 (Dissipation)** 或阻尼，倾向于抑制扰动，使系统回归稳定。

当正反馈足够强（即 $M_T^*$ 和 $M_D^*$ 足够大），以至于克服了所有的耗散项时，$\tau$ 变为正值 ($\tau > 0$)。此时，不动点失去稳定性，微小的扰动将随时间指数增长。

**2.行列式 (Determinant, $\Delta$)：不动点类型判据**

直接计算雅可比矩阵的行列式，可得：

$$
\Delta = \det(\mathcal{J}) = (-\mu + 2M_T^* M_D^*)(-(2 + (M_T^*)^2)) - (1 + (M_T^*)^2)(-1 - 2M_T^* M_D^*)
$$

化简上述表达式，我们得到一个关于 $M_T^*$ 和参数的显式多项式：

$$
\Delta = -2 M_T^* M_D^* + (M_T^*)^2\mu + (M_T^*)^2 + 2\mu + 1
$$

**物理意义与符号判断**：尽管该表达式包含负项，但在讲座讨论的生物物理相关参数区间内，特别是当满足振荡发生的必要几何条件 **$M_T^* > 1$** 时，可以证明 $\Delta$ 始终保持为正值。

**$\Delta > 0$** 意味着特征值的乘积为正，这表明两个特征值要么是同号实数（节点），要么是共轭复数（螺旋点）。这一性质严格排除了**鞍点 (Saddle Point, $\Delta < 0$)** 的可能性，确保了不动点周围流场的拓扑结构是旋转或汇聚/发散的，而非双曲逃逸的。

综上所述，当系统参数调节使得 **$\tau > 0$** 且 **$\Delta > 0$** 时，不动点成为一个**不稳定螺旋点 (Unstable Spiral)** 。轨道不仅会被排斥远离不动点，还会产生旋转特征，这是形成闭合极限环的必要几何条件。

**2.行列式 (Determinant, $\Delta$)：不动点类型判据**

$$
\Delta = \det(\mathcal{J}) = \frac{(M_T^*)^2 - 1}{\dots} \quad (\text{简化定性形式})
$$

**物理意义**：虽然行列式的完整代数表达式较为繁琐，但关键在于其符号。讲座指出，在发生振荡的参数区域（即满足 $\tau > 0$ 的条件时），通常伴随着一个几何约束 **$M_T^* > 1$** 。

当 $M_T^* > 1$ 时，可以证明 **$\Delta > 0$** 。这意味着特征值要么是同号实数（节点），要么是共轭复数（螺旋点），从而严格排除了鞍点（Saddle Point, $\Delta < 0$）的可能性。

综上所述，当系统参数调节使得 **$\tau > 0$** 且 **$\Delta > 0$** 时，不动点成为一个**不稳定螺旋点 (Unstable Spiral)** 。轨道不仅会被排斥远离不动点，还会产生旋转特征，这是形成闭合极限环的必要几何条件。

## 4.3 寻找振荡条件：不稳定螺旋点

根据上一讲建立的分类，要得到一个**不稳定螺旋点 (Unstable Spiral)** ，系统必须同时满足以下三个数学条件：

1.$\Delta > 0$：行列式为正（排除鞍点）。

2.$\tau > 0$：迹为正（系统不稳定，振幅增长）。

3.$\tau^2 - 4\Delta < 0$：判别式为负（特征值为复数，产生旋转）。

为了从参数 $(\mu, n)$ 中找到满足上述条件的区域，我们需要将不动点 $(M_T^*, M_D^*)$ 的几何位置与其代数性质联系起来。

### 1. 几何约束：为什么必须是 $M_T^* > 1$？

首先观察 $M_T$-零斜线的函数形式 $M_D = f(M_T) = \frac{\mu M_T}{1+M_T^2}$。对该函数求导以分析其斜率：
$$
f'(M_T) = \mu \frac{(1+M_T^2) - M_T(2M_T)}{(1+M_T^2)^2} = \mu \frac{1 - M_T^2}{(1+M_T^2)^2}
$$

由此可见：

* 当 $M_T < 1$ 时，斜率为正（零斜线处于上升段）。

* 当 $M_T = 1$ 时，斜率为零（峰值）。

* 当 **$M_T > 1$** 时，斜率为负（零斜线处于**下降段**）。

物理上，只有在下降段（$M_T > 1$），自催化项 $M_T^2$ 的增长速度才能在局部超过线性失活项，从而具备产生不稳定的潜力。因此，**不动点位于零斜线的下降段（即 $M_T^* > 1$）是产生振荡的必要几何前提。**

### 2. 代数证明：$\tau$ 与 $\Delta$ 的符号分析

利用不动点条件 $M_D^* = \frac{\mu M_T^*}{1+(M_T^*)^2}$，我们可以将雅可比矩阵中的 $M_D^*$ 消去，从而得到仅依赖于 $M_T^*$ 的表达式。

**关于迹 $\tau$ (判定不稳定性):**

将 $M_D^*$ 代入雅可比矩阵元素 $J_{11} = -\mu + 2M_T^* M_D^*$：

$$
J_{11} = -\mu + 2M_T^* \left( \frac{\mu M_T^*}{1+(M_T^*)^2} \right) = \mu \left( \frac{2(M_T^*)^2}{1+(M_T^*)^2} - 1 \right) = \mu \frac{(M_T^*)^2 - 1}{1+(M_T^*)^2}
$$

由此清晰可见，$J_{11}$ 的符号直接由 $(M_T^*)^2 - 1$ 决定。

* 若 $M_T^* < 1$，则 $J_{11} < 0$，配合恒负的 $J_{22}$，总迹 $\tau = J_{11} + J_{22}$ 必为负（系统稳定）。

* 只有当 **$M_T^* > 1$** 时，$J_{11}$ 才转为正值（正反馈主导），使得总迹 $\tau$ **有可能**变为正值（前提是正反馈足够强以克服 $J_{22}$ 的阻尼）。

**关于行列式 $\Delta$ (判定不动点类型):**

同样将 $M_D^*$ 代入上一节推导的 $\Delta$ 多项式中，经过化简可得：

$$
\Delta = \frac{\mu (M_T^{*4} + M_T^{*2} + 2)}{1 + (M_T^*)^2} + (1 + (M_T^*)^2)
$$

观察上式，由于 $\mu > 0$ 且 $M_T^*$ 为实数，表达式中的每一项均为正数。在物理有意义的参数范围内，$\Delta$恒大于0。这意味着系统永远不会出现鞍点。


产生振荡的物理图像现在变得非常清晰——我们需要调节参数 $n$ 和 $\mu$，迫使不动点移动到零斜线的**下降段 ($M_T^* > 1$)** 。在此区域内，$\Delta > 0$ 得到保证，且只要 $M_T^*$ 足够大，正反馈项将导致 $\tau > 0$，从而触发 Hopf 分岔并产生极限环。

## 4.4 Hopf 分岔与相图

为了在参数空间 $(\mu, n)$ 中精确勾勒出发生振荡的区域，我们需要找到满足 **Hopf 分岔条件** 的临界边界。严格来说，这条边界由以下方程组定义：

$$
\begin{cases}
\dot{M}_T = 0 \\
\dot{M}_D = 0 \\
\tau(\mu, n) = 0 \\
\Delta(\mu, n) > 0
\end{cases}
$$

前两个方程定义了不动点 $(M_T^*, M_D^*)$，第三个方程定义了稳定性切换的临界点。为了求解这个边界，我们需要建立控制参数与不动点之间的代数联系。

**1. 不动点的代数方程**

回顾零斜线方程，不动点是两条曲线的交点：
$$
M_D^* = \frac{\mu M_T^*}{1 + (M_T^*)^2} = \frac{n - M_T^*}{2 + (M_T^*)^2}
$$
通过联立上述等式，我们可以消去 $M_D^*$，得到一个仅关于活性浓度 $M_T^*$ 的**三次方程**：

$$
(\mu + 1)(M_T^*)^3 - n(M_T^*)^2 + (2\mu + 1)M_T^* - n = 0
$$

**2. 绘制相图的逻辑链**

有了这个代数方程，我们就补全了从参数到动力学行为的完整逻辑链：
1.**求解**：对于给定的参数 $(\mu, n)$，解上述三次方程得到不动点 $M_T^*$。

2.**代入**：将 $M_T^*$ 代回 $\tau$ 和 $\Delta$ 的表达式。

3.**判定**：
  * 若 $\tau < 0$，系统处于稳定区（不动点吸粉）。
  
  * 若 $\tau > 0$ 且 $\Delta > 0$，系统处于振荡区（极限环）。
  
  * 若 $\tau = 0$ 且 $\Delta > 0$，系统位于 **Hopf 分岔边界**。

**3.分岔现象：极限环的诞生**

当参数变化跨越这条 $\tau=0$ 的边界时，系统发生质变：

* **分岔前 ($\tau < 0$)**：不动点是**稳定螺旋点**，轨迹最终静止。

* **分岔后 ($\tau > 0$)**：不动点变为**不稳定螺旋点**。由于庞加莱-本迪克松定理限制了轨道不能发散（有界性），被排斥的轨道被迫卷曲成一个闭合的环——**极限环 (Limit Cycle)** 就此诞生。

![课堂板书截图](../assets/images/07_005_569fba08-8128-4a83-99c5-eca42fc88d23.png)

RhoGTPase 系统的 $(\mu, n)$ 相图。曲线勾勒出了由三次方程和 $\tau=0$ 确定的 Hopf 分岔边界。包围出的“U型”区域即为振荡区 (Oscillations)。

**4. 相图的物理直觉**

从相图中可以清晰地看到，振荡主要发生在大 $\mu$ 和大 $n$ 的区域。这揭示了产生细胞内生化振荡的两个核心物理条件：

1.**快速的负反馈 (Large $\mu$)** ：$\mu$ 很大意味着 $M_T$ 一旦生成，就会被迅速失活并踢回细胞质。这种“快速清除”机制防止了系统停滞在某个高浓度的稳态，是不稳定性的驱动力。

2.**充足的底物储备 (Large $n$)** ：$n$ 很大意味着细胞质中有一个巨大的 $C_D$ 储备库。即使膜上的 $M_T$ 被快速清除，巨大的储备库也能迅速补充 $M_D$ 到膜上，为下一轮的 $M_T$ 爆发提供原料。

**强劲的驱动（高储备）加上快速的刹车（高失活），导致了系统的持续震荡。**


## 4.5 Python 代码实践：模拟 Rho 振荡器
在这一节代码实践中，我们通过数值积分直接验证上一小节的 Hopf 分岔分析。

核心思路如下：

1.固定相对失活率 $\mu = 10.5$，仅改变总质量 $n$。

2.选取两个代表参数：

  - **稳定区**：$n = 15$，此时迹 $\tau < 0$、行列式 $\Delta > 0$，不动点为稳定螺旋点，所有轨道最终收敛到稳态；
  
  - **振荡区**：$n = 25$，此时迹 $\tau > 0$、行列式 $\Delta > 0$，不动点为不稳定螺旋点，轨道被排斥出稳态并被困在三角形陷阱区域内，根据庞加莱-本迪克松定理，系统会收敛到一个稳定的极限环。
  
  - 相平面轨迹 (phase portrait)：展示从同一初始条件出发，轨道在两种参数下分别收敛到点或极限环；
   
  - 时间序列 (time series)：展示 $M_T(t)$ 与 $M_D(t)$ 在时间上的演化，对比“指数衰减到稳态”和“长周期间振荡”的差异。
   
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

plt.style.use('dark_background')


def rho_2d_ode(t, y, mu, n):
    """
    Right-hand side of the 2D reduced RhoGTPase model.

    Parameters
    ----------
    t : float
        Time (not used explicitly, system is autonomous).
    y : array_like, shape (2,)
        State vector y = [M_T, M_D].
        M_T : active Rho on the membrane.
        M_D : inactive Rho on the membrane.
    mu : float
        Relative inactivation rate (strength of negative feedback).
    n : float
        Total protein mass (conservation: M_T + M_D + C_D = n).

    Returns
    -------
    dydt : list of float
        Time derivatives [dM_T/dt, dM_D/dt].
    """
    M_T, M_D = y

    # 2D ODE system (after eliminating C_D = n - M_T - M_D)
    dM_T = -mu * M_T + (1.0 + M_T**2) * M_D
    dM_D = (n - M_T - M_D) - (1.0 + M_T**2) * M_D

    return [dM_T, dM_D]


def simulate_rho(mu, n, y0, t_max, n_points=5000):
    """
    Integrate the Rho 2D ODE system for given parameters.

    Parameters
    ----------
    mu : float
        Relative inactivation rate.
    n : float
        Total protein mass.
    y0 : array_like, shape (2,)
        Initial condition [M_T(0), M_D(0)].
    t_max : float
        Final integration time.
    n_points : int, optional
        Number of time points for sampling the solution.

    Returns
    -------
    t : 1D ndarray
        Time points.
    sol : 2D ndarray
        Solution array with shape (2, len(t)).
        sol[0, :] : M_T(t)
        sol[1, :] : M_D(t)
    """
    t_span = (0.0, t_max)
    t_eval = np.linspace(t_span[0], t_span[1], n_points)

    sol = solve_ivp(
        rho_2d_ode,
        t_span,
        y0,
        t_eval=t_eval,
        args=(mu, n),
        rtol=1e-8,
        atol=1e-10
    )

    return sol.t, sol.y


def set_phase_limits(ax, M_T, M_D):
    """
    Set aesthetically pleasing limits and aspect ratio
    for a phase portrait panel.
    """
    mt_min, mt_max = M_T.min(), M_T.max()
    md_min, md_max = M_D.min(), M_D.max()

    # Add a small margin around the data range
    pad_x = 0.05 * (mt_max - mt_min) if mt_max > mt_min else 0.1
    pad_y = 0.05 * (md_max - md_min) if md_max > md_min else 0.1

    ax.set_xlim(mt_min - pad_x, mt_max + pad_x)
    ax.set_ylim(md_min - pad_y, md_max + pad_y)
    ax.set_aspect('equal', adjustable='box')


# -----------------------------
# Parameter choices and simulation
# -----------------------------
mu = 10.5              # fixed relative inactivation rate
n_stable = 15.0        # parameter in the stable-focus regime (tau < 0)
n_oscillatory = 25.0   # parameter in the oscillatory regime (tau > 0)

# Same initial condition for both parameter sets (inside the physical triangle)
y0 = [0.1, 0.1]

# Integrate the system in both regimes
t_stable, y_stable = simulate_rho(mu, n_stable, y0, t_max=200.0)
t_osc,    y_osc    = simulate_rho(mu, n_oscillatory, y0, t_max=400.0)

M_T_stable, M_D_stable = y_stable
M_T_osc,    M_D_osc    = y_osc

# For the oscillatory case, remove the initial transient and keep only
# the late-time motion on the limit cycle for the phase portrait
idx_transient = len(t_osc) // 2
M_T_osc_cycle = M_T_osc[idx_transient:]
M_D_osc_cycle = M_D_osc[idx_transient:]

# For the time series in the oscillatory regime, show only the last window_T
window_T = 100.0
t_max_osc = t_osc.max()
mask_osc_window = t_osc > (t_max_osc - window_T)

# -----------------------------
# Create a figure with phase portraits and time traces
# -----------------------------
fig, axes = plt.subplots(2, 2, figsize=(12, 8))  # no shared x-axis

ax_phase_stable = axes[0, 0]
ax_phase_osc    = axes[0, 1]
ax_time_stable  = axes[1, 0]
ax_time_osc     = axes[1, 1]

# --- (A) Phase portrait: stable focus ---
ax_phase_stable.plot(
    M_T_stable, M_D_stable,
    linewidth=2.0,
    label='trajectory'
)
ax_phase_stable.set_xlabel(r'$M_T$ (active membrane)')
ax_phase_stable.set_ylabel(r'$M_D$ (inactive membrane)')
ax_phase_stable.set_title(
    r'Stable focus: $\mu = 10.5,\ n = 15$',
    fontsize=11
)
ax_phase_stable.grid(alpha=0.3, linestyle=':')
set_phase_limits(ax_phase_stable, M_T_stable, M_D_stable)

# --- (B) Phase portrait: limit cycle (only late-time motion) ---
ax_phase_osc.plot(
    M_T_osc_cycle, M_D_osc_cycle,
    linewidth=2.0,
    label='trajectory'
)
ax_phase_osc.set_xlabel(r'$M_T$ (active membrane)')
ax_phase_osc.set_ylabel(r'$M_D$ (inactive membrane)')
ax_phase_osc.set_title(
    r'Limit cycle: $\mu = 10.5,\ n = 25$',
    fontsize=11
)
ax_phase_osc.grid(alpha=0.3, linestyle=':')
set_phase_limits(ax_phase_osc, M_T_osc_cycle, M_D_osc_cycle)

# --- (C) Time traces in the stable regime ---
ax_time_stable.plot(
    t_stable, M_T_stable,
    linewidth=1.8,
    label=r'$M_T(t)$'
)
ax_time_stable.plot(
    t_stable, M_D_stable,
    linewidth=1.2,
    linestyle='--',
    label=r'$M_D(t)$'
)
ax_time_stable.set_xlabel('time')
ax_time_stable.set_ylabel('concentration')
ax_time_stable.set_title(
    r'Time series (stable focus)',
    fontsize=11
)
ax_time_stable.legend(loc='upper right', fontsize=9)
ax_time_stable.grid(alpha=0.3, linestyle=':')

# --- (D) Time traces in the oscillatory regime (last window_T only) ---
ax_time_osc.plot(
    t_osc[mask_osc_window], M_T_osc[mask_osc_window],
    linewidth=1.8,
    label=r'$M_T(t)$'
)
ax_time_osc.plot(
    t_osc[mask_osc_window], M_D_osc[mask_osc_window],
    linewidth=1.2,
    linestyle='--',
    label=r'$M_D(t)$'
)
ax_time_osc.set_xlabel('time')
ax_time_osc.set_ylabel('concentration')
ax_time_osc.set_title(
    rf'Time series (limit cycle, last {window_T:.0f} time units)',
    fontsize=11
)
ax_time_osc.legend(loc='upper right', fontsize=9)
ax_time_osc.grid(alpha=0.3, linestyle=':')

# Global figure title (English caption)
fig.suptitle(
    "Figure 4.5  Numerical simulation of the 2D Rho oscillator\n"
    "Top: phase portraits. Bottom: time traces in stable vs. oscillatory regimes.",
    fontsize=12
)

# Make sure layout works well on a dark background
fig.tight_layout(rect=[0, 0.03, 1, 0.92])

# Save the figure with a dark-friendly background
plt.savefig(
    "rho_oscillator_phase_time.png",
    dpi=300,
    bbox_inches="tight"
)

plt.show()
```

![运行代码输出](../assets/images/07_006_aea062d8-475b-4948-82f3-0ba967f1ce27.png)


图展示了 RhoGTPase 二维模型在不同参数条件下的两类典型动力学行为，这与前面基于迹–行列式分析所得的 Hopf 分岔结论一致。

在**稳定区**（$μ = 10.5, n = 15$），相图中的轨迹以螺旋方式逐渐收敛到唯一的不动点，时间序列表现为快速衰减后进入稳定稳态。这说明在该参数条件下，系统的负反馈作用占主导，迹 $τ < 0$，特征值具有负实部，因而所有扰动最终都会被阻尼掉。

相比之下，在**振荡区**（$μ = 10.5, n = 25$），相图上的轨迹不再落入不动点，而是被排斥到一条闭合的轨道上；时间序列显示为振幅稳定、不再衰减的持续周期振荡。这对应于 $τ > 0、Δ > 0$ 的不稳定螺旋点：正反馈（自催化）足以克服耗散，使系统被迫在有界区域内沿闭合轨迹运行。根据庞加莱–本迪克松定理，这正是极限环出现的充分条件。

总体来看，这组数值结果验证了理论部分的关键逻辑链：质量守恒 → 降维为二维系统 → 不动点失稳（Hopf） → 在有界区域内出现稳定极限环。这表明模型具有产生自发振荡的能力，并为理解细胞膜上活性 Rho 的周期性动态提供了直观的动力学证据。


# 5. 演化博弈论：石头-剪刀-布

课程的最后一部分从细胞内部的生化网络转向了生态与社会系统中的策略竞争。以经典的 **石头-剪刀-布 (Rock-Paper-Scissors, RPS)** 游戏为例，这小节展示了动力系统框架的普适性：无论是分子间的化学反应，还是物种间的相互博弈，其演化规律都可以用相同的数学语言——非线性常微分方程来描述。此外，通过引入流行文化中的例子，如《生活大爆炸》中的扩展版游戏，我们看到这种数学框架可以轻松推广到任意数量策略的复杂系统，揭示了从简单的循环竞争到复杂的混沌边缘的丰富动力学行为。

## 5.1 零和博弈与复制子动力学

**零和博弈 (Zero-Sum Games)** 指的是一种严格的竞争关系：一方的收益必然等同于另一方的损失，系统总收益为零。最著名的例子便是孩童皆知的 RPS 游戏。


![课堂PPT截图](../assets/images/07_007_c7faeecd-9b9a-45d3-b2d6-47b3b9808ce0.png)

零和博弈的策略网络拓扑。左图 (S=3)：经典的 RPS 循环克制关系。中图 (S=5)：《生活大爆炸》中的“石头-剪刀-布-蜥蜴-斯波克”扩展版。右图 (S>>1)：当策略数量极大时，系统展现出复杂的网络连接结构。

为了增加趣味性，课程引用了美剧《生活大爆炸》中的片段，展示了当策略空间扩展时（例如引入“蜥蜴”和“斯波克”），博弈规则依然保持着某种反对称的循环结构。


![课堂展示的视频片段截图](../assets/images/07_008_2f1e1538-98e0-4d16-9314-43b662767195.jpg)

美剧《生活大爆炸》中谢尔顿解释“石头-剪刀-布-蜥蜴-斯波克”游戏的场景。

在演化博弈论中，关注点不再是单个理性玩家的决策，而是整个种群中不同策略（如出石头 R、出布 P、出剪刀 S）的分布演化。这里引入了 **复制子动力学 (Replicator Dynamics)** 的核心思想：

**策略即物种**：将不同的策略视为生态系统中的不同物种。

**赢即复制 (Winning = Replicating)** ：个体的“收益”对应于其“适应度”或繁殖率。当持有某策略的个体在博弈中获胜时，它获得资源并繁殖更多的后代（或者诱导失败者模仿其策略）。

## 5.2 建立动力学方程：从博弈到反应动力学

为了建立数学模型，课程巧妙地将博弈过程类比为**化学反应动力学 (Reaction Kinetics)** 。每一次博弈可以看作是两个个体（分子）的碰撞反应：

1.**R + S $\to$ R + R**：石头 (R) 遇到剪刀 (S)，石头胜。这相当于一个 S 个体被转化（或被替换）为了 R 个体。

2.**S + P $\to$ S + S**：剪刀 (S) 遇到布 (P)，剪刀胜。P 个体转化为 S 个体。

3.**P + R $\to$ P + P**：布 (P) 遇到石头 (R)，布胜。R 个体转化为 P 个体。

利用**质量作用定律 (Law of Mass Action)** ，可以立即写出描述这三种策略在种群中占比（浓度）变化的速率方程。

设 $[R], [P], [S]$ 分别为三种策略的种群比例（满足 $[R]+[P]+[S]=1$）。以 $[R]$ 的演化为例：

**增长项**：源于 $R$ 战胜 $S$。其速率正比于两者相遇的概率，即 $+a_{RS}[R][S]$。

**衰减项**：源于 $R$ 输给 $P$。其速率正比于两者相遇的概率，即 $-a_{PR}[R][P]$。


![课堂PPT截图](../assets/images/07_009_d9380f5a-1a43-4175-8e1c-03bb2cd71b08.png)

RPS 模型的反应动力学方程推导。展示了从成对碰撞反应到速率方程的映射过程。

将三个策略的方程联立，得到如下非线性微分方程组：

$$
\begin{cases}
\displaystyle \frac{d[R]}{dt} = a_{RS}[R][S] - a_{PR}[R][P] \\
\displaystyle \frac{d[P]}{dt} = a_{PR}[P][R] - a_{SP}[P][S] \\
\displaystyle \frac{d[S]}{dt} = a_{SP}[S][P] - a_{RS}[S][R]
\end{cases}
$$


![课堂PPT截图](../assets/images/07_010_772f27bb-5e7e-4679-bf1b-17fa295bc474.jpg)

该方程组在数学物理中被称为“反对称洛特卡-沃尔泰拉方程”，它连接了博弈论、玻色-爱因斯坦凝聚和拓扑相变等多个领域。

这一方程组的核心特征在于相互作用矩阵（收益矩阵）的**反对称性 (Anti-symmetry)** ：

$$
A = \begin{pmatrix} 0 & -a_{PR} & a_{RS} \\ a_{PR} & 0 & -a_{SP} \\ -a_{RS} & a_{SP} & 0 \end{pmatrix}
$$

这意味着 $A_{ji} = -A_{ij}$，深刻体现了“零和博弈”的守恒本质。这种循环相克 ($R \to S \to P \to R$) 的拓扑结构，导致系统不存在单一的稳定策略，而是倾向于产生**中性振荡 (Neutral Oscillations)** 或异宿环 (Heteroclinic Cycles)，这与生物分子网络中的振荡有着异曲同工之妙。

## 5.3 Python 模拟代码 3: 模拟 RPS 动力学

下面的代码数值求解了这个三维动力系统。由于总比例守恒 ($[R]+[P]+[S]=1$)，系统轨迹实际上被限制在一个二维单纯形（三角形）面上。模拟结果展示了策略比例如何随时间呈现出周期性的此消彼长。

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp
from mpl_toolkits.mplot3d import Axes3D

# Set dark background style
plt.style.use('dark_background')

def rps_system_deriv(t, y, a_RS, a_SP, a_PR):
    """
    Defines the 3D ODE system for the Rock-Paper-Scissors replicator dynamics.
    y = [R, P, S]
    """
    R, P, S = y
    
    # Growth driven by winning - Decay driven by losing
    # d[R]/dt = a_RS * R * S - a_PR * R * P
    dR_dt = a_RS * R * S - a_PR * R * P
    
    # d[P]/dt = a_PR * P * R - a_SP * P * S
    dP_dt = a_PR * P * R - a_SP * P * S
    
    # d[S]/dt = a_SP * S * P - a_RS * S * R
    dS_dt = a_SP * S * P - a_RS * S * R
    
    return [dR_dt, dP_dt, dS_dt]

# --- Simulation Parameters ---
# Interaction rates (Set to 1.0 for a symmetric cycle)
a_RS = 1.0
a_SP = 1.0
a_PR = 1.0
params = (a_RS, a_SP, a_PR)

# Initial conditions (Must sum to 1.0 for population fractions)
# Starting slightly off-center to induce oscillations
y0 = [0.2, 0.3, 0.5] 
t_span = [0, 50]

# Solve the ODE
sol = solve_ivp(rps_system_deriv, t_span, y0, args=params, 
                dense_output=True, method='RK45', rtol=1e-9)

R_traj = sol.y[0]
P_traj = sol.y[1]
S_traj = sol.y[2]

# --- Plotting ---
fig = plt.figure(figsize=(14, 6))

# Plot 1: Time Series
ax1 = fig.add_subplot(1, 2, 1)
ax1.plot(sol.t, R_traj, 'r-', linewidth=2, label='Rock [R]')
ax1.plot(sol.t, P_traj, 'g-', linewidth=2, label='Paper [P]')
ax1.plot(sol.t, S_traj, 'b-', linewidth=2, label='Scissors [S]')
ax1.set_xlabel('Time', color='white')
ax1.set_ylabel('Population Fraction', color='white')
ax1.set_title('RPS Dynamics: Time Series', color='white')
ax1.legend()
ax1.grid(True, linestyle=':', alpha=0.4)

# Plot 2: Phase Space Trajectory (3D)
ax2 = fig.add_subplot(1, 2, 2, projection='3d')
# Plot the trajectory
ax2.plot(R_traj, P_traj, S_traj, 'w-', linewidth=1.5)
# Mark Start and End
ax2.scatter(R_traj[0], P_traj[0], S_traj[0], color='white', s=50, label='Start')
ax2.scatter(R_traj[-1], P_traj[-1], S_traj[-1], color='red', s=50, label='End')

# Labels and Style
ax2.set_xlabel('Rock', color='white')
ax2.set_ylabel('Paper', color='white')
ax2.set_zlabel('Scissors', color='white')
ax2.set_title('RPS Dynamics: Phase Portrait (Simplex)', color='white')

# Adjust 3D axis pane colors for dark theme visibility
ax2.w_xaxis.set_pane_color((0.2, 0.2, 0.2, 1.0))
ax2.w_yaxis.set_pane_color((0.2, 0.2, 0.2, 1.0))
ax2.w_zaxis.set_pane_color((0.2, 0.2, 0.2, 1.0))
ax2.grid(False) # Clean look
ax2.legend()

plt.suptitle(f'Evolutionary Game Theory: RPS Cycle ($a_{{ij}}=1.0$)', color='white', fontsize=14)
plt.tight_layout()
plt.show()
```

![运行代码输出](../assets/images/07_011_6315e0dc-d8d7-4c2b-ae2e-cab04a874edf.png)

**左图 (Time Series)**: 三种策略的比例随时间呈现出相位差恒定的波浪式起伏。当“石头”增多时，“布”因为有了更多猎物而随之增加，进而抑制了“石头”，随后“剪刀”因天敌减少而复苏。这正是经典的 **Lotka-Volterra** 捕食者-猎物循环在三维系统中的推广。

**右图 (Phase Portrait)**: 在三维相空间中，由于总比例守恒 ($R+P+S=1$)，轨迹被限制在一个平面三角形内。闭合的环形轨道表明系统处于中性稳定状态（类似保守系统中的谐振子），既不收敛于某个单一策略，也不发散，而是维持着生物多样性的动态平衡。

# 总结 (Conclusion)

这节课在整个课程体系中起到了重要的桥梁作用。通过突破**第6讲**中线性稳定性分析的“局域”限制，课程引入了解决二维系统“全局”动力学问题的核心拓扑工具——**庞加莱-本迪克松定理 (Poincaré-Bendixson Theorem)** 。该定理提供了一套清晰且实用的非构造性策略（即构建“陷阱区域”并证明内部存在“不稳定不动点”），为严格证明非线性振荡（极限环）的存在性奠定了数学基础。

课程的核心内容通过对**RhoGTPase 振荡器**这一生物物理实例的深度解析展开。分析过程完整展示了从生物化学反应网络构建非线性常微分方程（ODE）模型，利用**质量守恒 (Mass Conservation)** 这一物理约束将三维系统严格降维至二维，并结合零斜线几何分析与雅可比矩阵代数推导，最终确定发生 **Hopf 分岔** 并产生自持振荡的物理条件——即快速的负反馈机制（大 $\mu$）与充足的底物供给（大 $n$）。

此外，**石头-剪刀-布 (RPS)** 模型的引入，展示了动力系统框架（特别是复制子动力学）在生物物理之外（如演化博弈论）的广泛普适性，揭示了策略竞争中的循环演化规律。

虽然这节课推导了复制子动力学方程，但对其全局稳定性的深入探讨留待后续。在接下来的**第8讲**中，将引入**李雅普诺夫函数 (Lyapunov Function)** 这一强大的分析工具，用于严格判定演化系统的全局稳定性，并揭示其如何导致**凝聚 (Condensation)** 现象（即在竞争中只有部分策略能幸存）。

更为关键的是，迄今为止的所有模型均基于“0维”假设（即空间均匀混合）。这对于理解真正的“自组织”与“模式形成”是远远不够的。第8讲将迈出决定性的一步，正式引入**空间 (Space)** 维度，通过推导**扩散方程 (Diffusion Equation)** 来描述粒子（或策略）的空间输运。这将打通从常微分方程（ODEs）通向偏微分方程（PDEs），即**反应-扩散系统 (Reaction-Diffusion Systems)** 的道路，为后续探索图灵斑图等复杂的时空自组织现象奠定基础。

