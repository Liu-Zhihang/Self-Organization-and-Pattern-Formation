# 引言：从离散动力系统到连续场论的范式转换

在此前的课程中，分析的视角主要聚焦于零维或有限维度的动力系统。从**第2讲**的金茨堡-朗道势能景观，到**第7讲**的 RhoGTPase 分子开关循环及岩石-剪刀-布生态循环，这些模型的一个共同特征是基于“均匀混合”（well-mixed）假设：关注的是某一物种的总数量或某一化学物质的总体浓度，而忽略了它们在空间上的分布差异。这类系统的数学语言是常微分方程（ODEs），其核心关注点在于时间维度上的演化——系统是趋向于一个不动点（Fixed Point），还是进入一个极限环（Limit Cycle）振荡，亦或是陷入混沌（Chaos）。

**第8讲**通过从微观随机游走推导出宏观扩散方程，迈出了引入空间维度的关键一步，确立了物质如何在空间中输运的物理基础。然而，仅仅有扩散是不够的。当我们放眼更广阔的物理世界，从凝聚态物理中的超导体涡旋点阵，到流体力学中的瑞利-贝纳德对流斑图，再到生物发育过程中的图灵斑图，空间自由度不仅不可忽略，甚至是现象的核心。所谓的“模式”（Pattern），本质上就是物理量在空间上的非均匀有序分布。为了描述这种空间延展系统（Spatially Extended Systems），必须将前几讲的非线性反应动力学与**第8讲**的空间扩散机制相结合，进行一次深刻的范式转换：**从有限自由度的动力系统过渡到无限自由度的场论（Field Theory）**。

在本讲中，系统的状态不再由一组离散的变量 $\vec{X}(t)$ 描述，而是引入了**场**的概念 $\phi(\vec{x}, t)$。这个标量场 $\phi$ 可以代表磁性材料中的局域磁化强度（Magnetization），二元合金中的局域组分浓度，或者生物组织中的某种形态发生素浓度。物理学中处理此类复杂系统的核心思想是**粗粒化（Coarse-graining）**。与其追踪每一个原子、电子或分子的微观运动（这将导致 $10^{23}$ 量级的天文数字般的自由度），不如通过平均化过程，定义介观尺度上的有效变量。这种方法论的巨大成功在于其**普适性（Universality）**：截然不同的微观系统——无论是铁磁体的自旋翻转，还是二元液体的相分离——在临界点附近往往遵循相同的宏观动力学方程。

这节课阐述如何基于对称性原则和热力学定律，构建描述非守恒标量场动力学的 **Ginzburg-Landau (GL) 理论**，并推导著名的 **Model A**（亦称 **Allen-Cahn 方程**）。分析将深入剖析该模型的每一个数学细节，从自由能泛函的构建到变分原理的应用，从线性稳定性分析到数值模拟的实现。这一理论框架不仅解释了相分离的早期动力学，也为下一讲中深入探讨**界面动力学（Interface Dynamics）**与**曲率驱动流（Curvature-Driven Flow）**奠定了数学与物理基础。


# 1. 统计物理基石：Ising模型与Landau平均场理论

为了构建描述空间延展系统的场论模型，这节课首先回顾统计物理中最基础的模型——Ising模型，并以此引入Landau平均场理论。这一理论框架不仅是将微观离散自由度粗粒化为宏观连续场的关键步骤，也为后续理解非平衡态动力学中的相变与模式形成提供了热力学势能基础。

## 1.1 Ising模型的物理图景

Ising模型提供了一个描述磁性系统相变的最简微观图景。考虑一个晶格系统，每个格点 $i$ 上存在一个离散的自旋变量 $s_i$，其取值仅限于 $+1$（自旋向上）或 $-1$（自旋向下）。自旋之间存在倾向于使相邻自旋方向一致的铁磁相互作用。

为了从微观过渡到宏观，定义**序参量 (Order Parameter)** $\phi$ 为局部区域内自旋的平均值。这一宏观变量的统计行为决定了系统的热力学相：

**高温相 (High Temperature Phase)** ：热涨落剧烈，克服了相互作用能，导致自旋取向随机化。宏观上，局部平均磁化强度 $\phi \approx 0$。系统处于**无序状态 (Disordered Phase)** ，对应物理上的顺磁性 (Paramagnetism)。

**低温相 (Low Temperature Phase)** ：铁磁相互作用能主导，抑制了热涨落，系统发生**自发对称性破缺 (Spontaneous Symmetry Breaking)** 。自旋倾向于集体朝上 ($\phi > 0$) 或集体朝下 ($\phi < 0$)。系统处于**有序状态 (Ordered Phase)** ，对应物理上的铁磁性 (Ferromagnetism)。

## 1.2 Landau自由能密度的构建原则

Lev Landau 在1937年提出的相变理论指出，在相变点附近，序参量 $\phi$ 的数值很小，因此可以将系统的自由能密度 $f(\phi)$ 展开为 $\phi$ 的幂级数。构建该自由能泛函的核心依据是系统的**对称性**。

对于Ising类系统，物理定律具有 **$\mathbb{Z}_2$ 对称性**（即上下翻转对称性）：系统能量不应依赖于“向上”或“向下”的正负定义。这意味着自由能密度必须满足偶函数性质：

$$
f(\phi) = f(-\phi)
$$

基于此对称性约束，展开式中只能包含 $\phi$ 的偶数次幂。保留至四阶项的 Landau 自由能密度形式如下：

$$
f(\phi) = f_0 - \frac{r}{2}\phi^2 + \frac{u}{4}\phi^4
$$

其中 $f_0$ 为背景自由能（通常设为0）。此处各系数的符号与物理意义至关重要，特别是二次项系数的符号约定：


![课堂PPT截图](../assets/images/09_001_2f4a7d13-4707-41b4-ad84-b1e877d599b5.png)

Landau自由能密度 $f(\phi)$ 随控制参数 $r$ 的变化。虚线表示高温相（单势阱），实线表示低温相（双势阱）。

**二次项系数 $r$ (控制参数)：**

该参数控制相变过程，线性依赖于温度偏差：$r \propto (T_c - T)$（注意符号差异）。在Erwin Frey教授的板书约定中，公式写作 **$-\frac{r}{2}\phi^2$** 。为了保证物理图像的正确性，需要仔细分析 $r$ 的符号对势能形状的影响：

**高温相 ($T > T_c$)** ：系统处于无序态，$\phi=0$ 必须是势能的全局极小值（稳定点）。对于函数 $ax^2$，需 $a>0$。因此，$-\frac{r}{2} > 0 \Rightarrow r < 0$。此时势能曲线为开口向上的单阱抛物线。

**低温相 ($T < T_c$)** ：系统处于有序态，$\phi=0$ 必须变为局部极大值（不稳定点），从而允许非零解的出现。因此，$-\frac{r}{2} < 0 \Rightarrow r > 0$。此时势能曲线在原点处上凸，在两侧形成两个对称的极小值势阱（双阱势，Double-Well Potential）。

**四次项系数 $u$ (稳定性参数)：**

为了保证热力学稳定性，自由能必须有下界。当 $|\phi| \to \infty$ 时，最高次项 $\phi^4$ 主导。因此必须要求 **$u > 0$** ，确保势能在无穷远处趋于正无穷，防止系统“塌缩”至无限大的序参量状态。

**外场项 $h$ (对称性破缺场)：**

若存在外部磁场 $h$，系统的 $\mathbb{Z}_2$ 对称性被显式破坏，自由能需加入线性项 $-h\phi$：

$$
f(\phi) = -\frac{r}{2}\phi^2 + \frac{u}{4}\phi^4 - h\phi
$$

这一项会导致自由能景观发生倾斜（Tilt），使得其中一个势阱比另一个更深，从而偏向某一特定的磁化方向。

## 1.3 分岔图与临界行为 (Bifurcation Diagram)

通过求解极值条件 $f'(\phi) = 0$，可以得到序参量稳态值 $\phi^*$ 随控制参数 $r$ 的变化关系。这种数学结构在动力系统理论中被称为**超临界叉式分岔 (Supercritical Pitchfork Bifurcation)** 。

![课堂PPT截图](../assets/images/09_002_a9142d87-ca5d-4ce0-90d6-20489db0725e.png)

序参量稳态值 $\phi^*$ 随控制参数 $r$ 的变化分岔图。当 $r$ 穿过零点时，系统从单稳态（无序）突变为双稳态（有序）。

各阶段的物理状态与数学特征总结如下：

| 控制参数 $r$ | 自由能形状 $f(\phi)$ | 稳态解 $\phi^*$ (极值点) | 物理状态 | 分岔类型 |
| :--- | :--- | :--- | :--- | :--- |
| **$r < 0$** <br> (高温) | **单势阱** <br> (Single Well) | $\phi^* = 0$ <br> (唯一稳定，全局极小) | **顺磁相** <br> (无序 Disordered) | - |
| **$r = 0$** <br> (临界点) | **平底四次势** <br> (Flat bottom) | $\phi^* = 0$ <br> (临界稳定，二阶导为0) | **相变点** <br> (临界慢化) | - |
| **$r > 0$** <br> (低温) | **双势阱** <br> (Double Well) | $\phi^* = 0$ (不稳定，局部极大) <br> $\phi^* = \pm\sqrt{r/u}$ (稳定，全局极小) | **铁磁相** <br> (有序 Ordered) | **叉式分岔** <br> (Pitchfork) |

**临界行为解析：**
当控制参数 $r$ 从负值逐渐增加并穿过零点时，原本稳定的原点 $\phi=0$ 突然失去稳定性（失稳），并在其两侧“分岔”出两个新的稳定分支 $\pm\sqrt{r/u}$。系统必须从这两个等价的状态中“选择”一个，这正是**自发对称性破缺**的数学体现。这一简单的多项式模型不仅成功捕捉了磁体相变的本质，也普适地描述了诸如欧拉压杆失稳、激光阈值产生等广泛的物理现象。

# 2. 空间非均匀性的代价：Ginzburg-Landau自由能泛函

前一小节讨论的 Landau 平均场理论虽然成功解释了相变的基本特征，但它本质上是一个“零维”理论。它假设序参量 $\phi$ 在整个样本空间中是均匀分布的常数，忽略了所有空间涨落。然而，在真实物理系统中，空间结构无处不在：从临界点附近的剧烈热涨落，到铁磁体中的磁畴壁 (Domain Walls)，再到气液两相共存时的相界面。为了描述这些现象，必须将序参量推广为空间坐标的函数 $\phi(\vec{x})$，即引入**场 (Field)** 的概念。

相应的，系统的总能量不再是一个简单的单变量函数，而是依赖于场分布形态的**泛函 (Functional)** ，记为 $\mathcal{F}[\phi]$。本节将展示如何基于对称性原则和长波近似，构建描述空间非均匀系统的 Ginzburg-Landau (GL) 自由能泛函。

## 2.1 梯度展开法 (Gradient Expansion)

构建泛函的核心思想是**梯度展开**。物理上假设在介观尺度下，场 $\phi(\vec{x})$ 的空间变化相对于微观原子尺度是缓慢的（即**长波近似**，Long-wavelength approximation）。因此，可以将总自由能写成局域自由能密度与梯度修正项的空间积分：

$$
\mathcal{F}[\phi] = \int d^d x \left[ f(\phi(\vec{x})) + f_{\text{grad}}(\nabla \phi, \nabla^2 \phi, \dots) \right]
$$

对于梯度项 $f_{\text{grad}}$ 的形式，必须满足以下严格的物理对称性限制：

**旋转不变性 (Rotational Invariance)** ：自由能必须是标量，其数值不应依赖于坐标系的选择。因此，梯度项不能包含孤立的矢量（如 $\nabla \phi$），只能由标量组合构成，例如 $(\nabla \phi)^2$, $(\nabla^2 \phi)^2$, 或 $(\nabla \phi \cdot \nabla \phi)$ 等。

**空间反演对称性 (Parity)** ：对于各向同性系统，$\vec{x} \to -\vec{x}$ 不应改变能量。

**序参量反演对称性** ：对于 Ising 类系统，物理定律在 $\phi \to -\phi$ 变换下保持不变。这要求梯度项必须是 $\phi$ 及其导数的偶次函数。项如 $\phi (\nabla \phi)$ 在体积分后通常转化为边界项或零，而 $(\nabla \phi)^2$ 在 $\phi$ 变号时保持不变（因为 $(-1)^2=1$）。


在长波近似下，空间导数的阶数越高，其对应于傅里叶空间中的波数 $q$ 的幂次也越高。为了描述最主要的物理效应，通常只需保留**最低阶的非零导数项**。根据上述分析，这一项即为 $(\nabla \phi)^2$。

## 2.2 Ginzburg-Landau (GL) 自由能泛函

将局域势能项 $f(\phi)$（来自 Landau 理论）与最低阶梯度项结合，便得到了现代理论物理中最著名的泛函之一——**Ginzburg-Landau 自由能泛函**：

$$
\mathcal{F}[\phi(\vec{x})] = \int d^d x \left[ \underbrace{-\frac{r}{2}\phi^2 + \frac{u}{4}\phi^4}_{\text{局域势能 } f(\phi)} + \underbrace{\frac{\kappa}{2}(\nabla \phi)^2}_{\text{梯度能 (弹性罚分)}} \right]
$$

Ginzburg-Landau 自由能泛函的数学形式，展示了局域势能项与梯度项的加和结构。这一公式不仅是统计物理处理连续相变的标准模型，也是粒子物理中 Higgs 机制和超导唯象理论的数学基础。

## 2.3 刚度系数 $\kappa$ 的物理诠释


![课堂板书截图](../assets/images/09_003_4699c874-7395-4b78-b711-382ee6b5eac4.png)


梯度项前的系数 $\kappa$ 在不同物理语境下被称为**刚度 (Rigidity)**、**劲度 (Stiffness)** 或梯度系数。它深刻影响着系统的空间构型：

**平滑作用与稳定性**：

热力学稳定性要求 $\kappa > 0$。

若 $\kappa > 0$，任何空间不均匀性（$\nabla \phi \neq 0$）都会导致总能量增加。这就像一根被拉伸的橡皮筋，系统具有一种抗拒空间变化、倾向于使场 $\phi$ 变得平滑均匀的“弹性”。因此，这一项也被称为**弹性罚分 (Elastic Penalty)** 。

若 $\kappa < 0$，系统会倾向于产生无限剧烈的空间震荡（高频模式）以降低能量，导致基态不存在（热力学不稳定）。

**关联长度 (Correlation Length)** ：

系统中存在两种竞争机制：局域势能 $f(\phi)$ 倾向于使 $\phi$ 处于势阱极小值（有序化），而梯度能 $\frac{\kappa}{2}(\nabla \phi)^2$ 倾向于抹平空间差异（均匀化）。这两者的竞争定义了一个特征长度尺度——**关联长度 $\xi$** 。

通过量纲分析（Dimensional Analysis）可以估算这一尺度：

将梯度项 $\kappa (\phi/L)^2$ 与二次势能项 $|r| \phi^2$ 进行比较，当两者量级相当时：

$$
\frac{\kappa}{L^2} \sim |r| \implies L \sim \sqrt{\frac{\kappa}{|r|}}
$$

因此，定义关联长度为：

$$
\xi = \sqrt{\frac{\kappa}{|r|}}
$$
    
这一公式揭示了二阶相变的标志性特征：当系统趋近临界点 ($T \to T_c$) 时，控制参数 $r \to 0$，导致关联长度发散 ($\xi \to \infty$)。这意味着在相变点附近，系统中一点的涨落可以“感知”并影响到无穷远处的区域，导致宏观尺度的集体行为。

# 3. 非平衡弛豫动力学：Model A (Allen-Cahn方程) 的推导

在确立了 Ginzburg-Landau 自由能泛函 $\mathcal{F}[\phi]$ 这一静态能量景观后，理论构建的下一步是引入时间维度，探索系统如何从非平衡初态（例如高温淬火后）演化至平衡态。对于**非守恒标量场 (Non-conserved scalar field)** ——即序参量 $\phi$ 的空间总积分不守恒（例如磁矩可以自由翻转，或者光子数量不守恒）——其动力学遵循最自然的物理直觉：系统总是沿着能量景观最陡峭的下降方向演化。这一过程被称为弛豫动力学 (Relaxational Dynamics)。

## 3.1 唯象动力学假设：最速下降原理

为了描述场的演化，理论引入了 Onsager 线性响应假设。该假设认为，推动序参量 $\phi(\vec{x}, t)$ 随时间变化的热力学广义力，正是自由能泛函对场的变分导数（Functional Derivative）的负值。

相应的动力学方程可以写为：

$$
\frac{\partial \phi(\vec{x}, t)}{\partial t} = -\Lambda \frac{\delta \mathcal{F}[\phi]}{\delta \phi(\vec{x}, t)}
$$

非守恒标量场的动力学方程定义，其中 $\Lambda$ 为 Onsager 动力学系数。

**Onsager 系数 $\Lambda$** ：这是一个唯象的动力学输运系数（Kinetic Coefficient），设定了系统弛豫的时间尺度。虽然它由微观物理机制决定，但在宏观场论中通常视为常数。为了简化数学表达，后续推导中常设定 $\Lambda = 1$（或将其吸收到时间单位中）。

**负号的物理含义** ：确保了能量耗散。这保证了演化流（Flow）总是指向自由能减小的方向，正如小球在重力势能面上总是滚向最低点。

在 Hohenberg 和 Halperin 的动力学临界现象分类综述中，这种仅由耗散和非守恒序参量构成的模型被命名为 **Model A**。在材料科学（如合金相分离）和数学物理领域，该方程更常被称为 **Allen-Cahn 方程**。

## 3.2 泛函微积分与变分推导详解

为了获得显式的偏微分方程 (PDE)，必须计算泛函导数 $\frac{\delta \mathcal{F}}{\delta \phi}$。这是一个涉及变分法的数学过程。

回顾 Ginzburg-Landau 泛函形式 $\mathcal{F} = \int d^d x \, \mathcal{L}(\phi, \nabla \phi)$，其中拉格朗日密度为：
$$
\mathcal{L} = f(\phi) + \frac{\kappa}{2}(\nabla \phi)^2
$$

考虑场 $\phi$ 发生微小变分 $\delta \phi$，泛函的变分 $\delta \mathcal{F}$ 为：

$$
\delta \mathcal{F} = \int d^d x \left[ \frac{\partial \mathcal{L}}{\partial \phi} \delta \phi + \frac{\partial \mathcal{L}}{\partial (\nabla \phi)} \cdot \delta (\nabla \phi) \right]
$$

**第一项（局域势能导数）**：

$$
\frac{\partial \mathcal{L}}{\partial \phi} = \frac{d}{d\phi} \left( -\frac{r}{2}\phi^2 + \frac{u}{4}\phi^4 \right) = -r\phi + u\phi^3 = f'(\phi)
$$

**第二项（梯度项导数与分部积分）**：

梯度项对 $\nabla \phi$ 的导数为 $\kappa \nabla \phi$。由于 $\delta (\nabla \phi) = \nabla (\delta \phi)$，积分中的第二部分为 $\kappa \nabla \phi \cdot \nabla (\delta \phi)$。为了提取公因子 $\delta \phi$，必须对该项进行**分部积分 (Integration by Parts)** ：

$$
\int d^d x \, (\kappa \nabla \phi) \cdot \nabla (\delta \phi) = \oint_{\partial V} (\kappa \nabla \phi \delta \phi) \cdot d\vec{S} - \int d^d x \, (\nabla \cdot (\kappa \nabla \phi)) \delta \phi
$$

通常假设在无穷远处场为零，或系统满足周期性边界条件，因此**表面积分项（第一项）消失**。保留下来的体积分项贡献了 $-\kappa \nabla^2 \phi$。

合并上述两部分，得到泛函导数的最终形式：

$$
\frac{\delta \mathcal{F}}{\delta \phi} = f'(\phi) - \kappa \nabla^2 \phi
$$

## 3.3 Allen-Cahn方程的物理结构

将变分结果代入动力学方程，并设 $\Lambda=1$，即得到了著名的 **Allen-Cahn 方程**（亦称 Model A）：

$$
\frac{\partial \phi}{\partial t} = - \left( f'(\phi) - \kappa \nabla^2 \phi \right)
$$

整理后，方程展现出清晰的物理结构：

$$
\frac{\partial \phi}{\partial t} = \underbrace{\kappa \nabla^2 \phi}_{\text{扩散项}} - \underbrace{f'(\phi)}_{\text{反应项}}
$$

或者显式写出势能导数：
$$
\frac{\partial \phi}{\partial t} = \kappa \nabla^2 \phi + (r\phi - u\phi^3)
$$

Allen-Cahn 方程的结构分解：扩散项（源自梯度能）与反应项（源自局域势能）。

这一方程在数学形式上属于经典的**反应-扩散方程 (Reaction-Diffusion Equation)** ，揭示了相变动力学中两种核心机制的竞争：


**扩散项 ($\kappa \nabla^2 \phi$)** ：源于梯度能罚分。它类似于热传导方程，倾向于抹平空间上的不均匀性，使场变得平滑。这对应于系统内的“弹性”恢复力。

**反应项 ($-f'(\phi)$)** ：源于局域双阱势。它是一个非线性的源项，驱动场 $\phi$ 远离不稳定的极大值点（$\phi=0$），并加速“滚落”至稳定的极小值点（$\pm \phi_0$）。这是一种局域的“自催化”机制，倾向于增强差异，形成明确的有序相。

正是这种试图“平滑化”的扩散机制与试图“分化”的反应机制之间的动态平衡，主导了畴壁形成与粗化等复杂的模式形成过程。

## 3.4 H-定理与 Lyapunov 泛函证明

该动力学模型是否保证系统最终能达到平衡态？是否存在永恒振荡的可能性？通过引入 Lyapunov 泛函的概念，可以严格证明系统的稳定性。

考察自由能 $\mathcal{F}$ 随时间的全导数：

$$
\frac{d\mathcal{F}}{dt} = \int d^d x \frac{\delta \mathcal{F}}{\delta \phi(\vec{x}, t)} \frac{\partial \phi(\vec{x}, t)}{\partial t}
$$

将运动方程 $\frac{\partial \phi}{\partial t} = -\Lambda \frac{\delta \mathcal{F}}{\delta \phi}$ 代入上式：

$$
\frac{d\mathcal{F}}{dt} = \int d^d x \frac{\delta \mathcal{F}}{\delta \phi} \left( -\Lambda \frac{\delta \mathcal{F}}{\delta \phi} \right) = -\Lambda \int d^d x \left( \frac{\delta \mathcal{F}}{\delta \phi} \right)^2
$$

由于 Onsager 系数 $\Lambda > 0$ 且被积函数是实数的平方（恒非负），因此自由能的时间导数必然非正：

$$
\frac{d\mathcal{F}}{dt} \leq 0
$$

等号仅在 $\frac{\delta \mathcal{F}}{\delta \phi} = 0$ 时成立，即系统达到自由能极值的平衡态。这一数学推导（类似于玻尔兹曼 H-定理）严格保证了 Model A 系统是一个**梯度流 (Gradient Flow)** 系统。在没有外力驱动的情况下，系统不存在极限环或混沌吸引子，其最终命运必然是静止于某个局部自由能极小态。

# 4. 线性稳定性分析与相变动力学

在建立了 Allen-Cahn 方程后，一个核心问题随之而来：如果系统处于某个均匀的稳态（例如高温下的无序相 $\phi=0$），当外部条件突然改变（例如温度骤降至临界点以下，即“淬火” Quench）时，这个均匀状态是否还能维持？微小的热涨落是会随时间衰减，还是会被放大从而破坏均匀性？为了回答这个问题，这小节采用**线性稳定性分析 (Linear Stability Analysis, LSA)** ，通过考察系统对微小扰动的响应，来揭示相变发生的早期动力学机制。

## 4.1 微扰展开与线性化方程

假设系统初始处于某个空间均匀的、与时间无关的稳态 $\phi^*$。根据定义，该稳态必须满足 $f'(\phi^*) = 0$（即局域势能的极值点）。现在，在 $\phi^*$ 之上叠加一个微小的时空扰动 $\delta \phi(\vec{x}, t)$：

$$
\phi(\vec{x}, t) = \phi^* + \delta \phi(\vec{x}, t)
$$


![课堂PPT截图](../assets/images/09_004_0a337a17-3e96-41c3-ac09-339776c7f822.png)

线性稳定性分析的基本设定：在均匀稳态 $\phi^*$ 附近引入微小扰动 $\delta \phi$。


将此表达式代入 Allen-Cahn 方程 $\partial_t \phi = -f'(\phi) + \kappa \nabla^2 \phi$。对于反应项 $f'(\phi)$，在 $\phi^*$ 处进行泰勒展开：
$$
f'(\phi^* + \delta \phi) \approx f'(\phi^*) + f''(\phi^*) \delta \phi + \mathcal{O}(\delta \phi^2)
$$
由于 $\phi^*$ 是稳态，首项 $f'(\phi^*) = 0$。忽略高阶项 $\mathcal{O}(\delta \phi^2)$，这一步骤即为**线性化**。扩散项是线性的，直接作用于 $\delta \phi$。

最终得到的线性化演化方程为：

$$
\frac{\partial \delta \phi(\vec{x}, t)}{\partial t} = -f''(\phi^*) \delta \phi(\vec{x}, t) + \kappa \nabla^2 \delta \phi(\vec{x}, t)
$$

## 4.2 傅里叶模与色散关系

上述方程是一个常系数线性偏微分方程。根据线性系统理论，其解可以分解为不同波矢量 $\vec{q}$ 的平面波模式的叠加。引入傅里叶变换：

$$
\delta \phi(\vec{x}, t) = \int \frac{d^d q}{(2\pi)^d} e^{-i \vec{q} \cdot \vec{x}} \delta \phi(\vec{q}, t)
$$

将空间扰动 $\delta \phi(\vec{x}, t)$ 分解为傅里叶模式 $\delta \phi(\vec{q}, t)$。

将傅里叶积分代入线性化方程，利用 $\nabla^2 e^{-i\vec{q}\cdot\vec{x}} = -q^2 e^{-i\vec{q}\cdot\vec{x}}$ 的性质，可以将偏微分方程转化为每个模式 $\vec{q}$ 独立的常微分方程：

$$
\frac{\partial \delta \phi(\vec{q}, t)}{\partial t} = \left[ -f''(\phi^*) - \kappa q^2 \right] \delta \phi(\vec{q}, t)
$$

该方程的解呈指数形式：$\delta \phi(\vec{q}, t) \sim e^{\sigma(q)t}$。其中 $\sigma(q)$ 被称为**增长率 (Growth Rate)** ，其随波数 $q$ 的变化关系称为**色散关系 (Dispersion Relation)** ：

$$
\sigma(q) = -f''(\phi^*) - \kappa q^2
$$


扰动模式的增长率 $\sigma(q)$，由局域势能曲率 $-f''(\phi^*)$ 和梯度罚分 $-\kappa q^2$ 共同决定。

这一公式清晰地展示了两种物理机制的竞争：

**局域反应项 $-f''(\phi^*)$** ：决定了反应动力学是抑制还是放大扰动，取决于势能曲线在该点的曲率。

**扩散项 $-\kappa q^2$** ：总是负值（因为 $\kappa > 0$），代表扩散作用总是倾向于抑制空间非均匀性，且波数 $q$ 越高（波长越短），抑制作用越强。

## 4.3 物理状态的稳定性判据

通过分析增长率 $\sigma(q)$ 的符号，可以严格判断不同物理状态的稳定性。

### 情形 A：在势阱极小值 $\phi_{\pm} = \pm\sqrt{r/u}$ 处（有序相）

当系统处于低温有序相的平衡位置 $\phi_{\pm}$ 时，局域势能处于极小值，其二阶导数（曲率）为正：
$$
f''(\phi_{\pm}) = -r + 3u(\pm\sqrt{r/u})^2 = -r + 3r = 2r > 0 \quad (\text{对于 } r>0)
$$
此时色散关系为：
$$
\sigma(q) = -2r - \kappa q^2
$$
由于 $r>0$ 且 $\kappa>0$，对于任意波数 $q$，都有 **$\sigma(q) < 0$** 。

**结论**：有序相是**线性稳定**的。这意味着任何波长的微小热涨落都会随时间指数衰减，系统具有很强的恢复力，能够自发维持在均匀的铁磁有序态。这解释了为什么低温下的磁体宏观状态是稳定的。

### 情形 B：在势垒顶端 $\phi_0 = 0$ 处（不稳定点与淬火）

这是相变动力学中最关键的情形，对应于将系统从高温相（$r<0$）突然冷却至低温相（$r>0$）的瞬间，即**淬火 (Quench)** 。此时，系统仍暂时停留在 $\phi=0$ 的位置，但在新的低温环境下，该位置已变成势能的极大值点（势垒顶端）。

此时势能曲率为负：
$$
f''(0) = -r < 0 \quad (\text{对于 } r>0)
$$
色散关系变为：
$$
\sigma(q) = r - \kappa q^2
$$

![课堂板书截图](../assets/images/09_005_5c3e86ef-9827-486b-9f52-ce7086c94fae.png)

在淬火条件下 ($\phi_0=0$)，增长率 $\sigma(q)$ 呈现倒抛物线型。存在一个**不稳定模态带 (band of unstable modes)** ，即 $0 \le q < q_c$ 的区域，这些模式会指数增长。

这一色散关系揭示了丰富的物理图像：

**长波不稳定性 (Long-wavelength Instability)** ：

当 $\kappa q^2 < r$ 时，即对于波数小于临界值 $q_c = \sqrt{r/\kappa}$ 的模式，增长率 $\sigma(q) > 0$。这些长波模式（波长 $\lambda > 2\pi\sqrt{\kappa/r}$）会随时间指数增长。这种由局域势能不稳定性驱动的长波涨落放大过程，被称为 **Spinodal Decomposition（失稳分解）**。

**短波稳定性** ：

当 $q$ 足够大（$q > q_c$）时，扩散项 $-\kappa q^2$ 占据主导，使得 $\sigma(q) < 0$。这意味着极短波长的剧烈涨落会被扩散迅速抹平，系统不会形成无限细碎的结构，这体现了表面张力（由 $\kappa$ 代表）对界面的平滑作用。

**最快增长模式与 Model A 特征** ：

在 Model A 中，增长率 $\sigma(q)$ 在 **$q=0$** 处达到最大值 $\sigma_{max} = r$。

这意味着，系统最倾向于以无限长的波长（即整体均匀地）演化。系统整体倾向于“滚落”到 $\phi_+$ 或 $\phi_-$ 中的某一个。这与守恒场动力学（**Model B / Cahn-Hilliard 方程**）形成了鲜明对比：在 Model B 中，由于守恒律限制，$\sigma(q=0)$ 必须为 0，最快增长模式出现在某个有限的 $q_{max} \neq 0$ 处，从而导致特征长度尺度的选择。而在 Model A 中，实际上观察到的畴壁形成涉及非线性效应，线性稳定性分析仅描述了动力学的最初始瞬间。


# 5. 代码实践：Allen-Cahn方程的计算实现

为了直观验证前述理论，特别是从高温无序态骤冷（Quench）至低温有序态后的动力学演化，Erwin Frey教授在课堂上展示了 Allen-Cahn 方程的数值模拟结果。这节课将通过 Python 代码复现这一模拟，通过数值实验“看到”相分离与斑图形成的全过程。

![课堂PPT截图](../assets/images/09_006_5f542c2e-b711-4be3-a43c-cbfa3657a2ec.jpg)


## 5.1 数值算法：有限差分法 (Finite Difference Method)

我们采用**显式欧拉法 (Explicit Euler)** 进行时间积分，并使用**中心差分 (Central Difference)** 处理空间拉普拉斯算子。这种方法虽然简单，但物理图像清晰，非常适合演示目的。

假设二维空间网格间距为 $\Delta x$，时间步长为 $\Delta t$。场变量 $\phi$ 在格点 $(i, j)$ 和时间步 $n$ 的离散值记为 $\phi^n_{i,j}$。

二维拉普拉斯算子的离散形式为：
$$
\nabla^2 \phi \approx \frac{\phi_{i+1,j} + \phi_{i-1,j} + \phi_{i,j+1} + \phi_{i,j-1} - 4\phi_{i,j}}{(\Delta x)^2}
$$

代入 Allen-Cahn 方程，得到迭代更新公式：
$$
\phi^{n+1}_{i,j} = \phi^n_{i,j} + \Delta t \left[ \kappa (\nabla^2 \phi)^n_{i,j} + (r\phi^n_{i,j} - u(\phi^n_{i,j})^3) \right]
$$

**数值稳定性警告 (CFL Condition)** ：
显式解法是条件稳定的。为了防止数值解发散（出现非物理的高频振荡），时间步长必须满足 Courant-Friedrichs-Lewy (CFL) 条件：
$$
\Delta t \leq \frac{(\Delta x)^2}{4\kappa}
$$
若 $\Delta t$ 超过此阈值，模拟将迅速崩溃。

## 5.2 Python完整代码实现

以下代码复现了课堂演示的物理场景：系统从接近 $\phi=0$ 的微小随机热涨落（高温无序态）开始，经历骤冷后演化出宏观有序结构。

```python
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation
from matplotlib.colors import LinearSegmentedColormap

# Use dark background style to match lecture slides
plt.style.use('dark_background')

# ==========================================
# 1. Physics & Simulation Parameters
# ==========================================
# Spatial parameters
N = 128                 # Grid size (N x N)
L = 100.0               # Physical size of the system
dx = L / N              # Spatial resolution
x = np.linspace(0, L, N)
y = np.linspace(0, L, N)

# Time parameters
dt = 0.01               # Time step
total_steps = 4000      # Total simulation steps
plot_interval = 50      # Frame update interval

# Ginzburg-Landau Model Parameters
kappa = 1.0             # Stiffness / Diffusion coefficient
r = 1.0                 # Control parameter (r > 0 for double well potential)
u = 1.0                 # Nonlinear coefficient (Quartic term)

# Stability Check (CFL Condition)
stability_limit = dx**2 / (4 * kappa)
print(f"Stability Check: dt = {dt}, Max Stable dt = {stability_limit:.4f}")
if dt > stability_limit:
    print("Warning: dt exceeds stability limit! Simulation may diverge.")

# ==========================================
# 2. Initial Condition (Quench)
# ==========================================
# Simulate a quench from high T (phi ~ 0) to low T.
# Initial state is small random noise around 0.
np.random.seed(42)  # Fixed seed for reproducibility
noise_strength = 0.1
phi = noise_strength * (2 * np.random.rand(N, N) - 1)  # Uniform noise in [-0.1, 0.1]

# ==========================================
# 3. Numerical Solver Kernel
# ==========================================
def laplacian_pbc(f, dx):
    """
    Compute 2D discrete Laplacian with Periodic Boundary Conditions (PBC).
    Using np.roll for efficient neighbor indexing.
    """
    left  = np.roll(f, -1, axis=0)
    right = np.roll(f,  1, axis=0)
    up    = np.roll(f, -1, axis=1)
    down  = np.roll(f,  1, axis=1)
    
    return (left + right + up + down - 4 * f) / (dx**2)

def update_step(phi, dt, dx, kappa, r, u):
    """
    Execute one Forward Euler time step.
    Equation: dphi/dt = kappa * grad^2 phi + (r*phi - u*phi^3)
    """
    # Diffusion term (Elastic relaxation)
    lap = laplacian_pbc(phi, dx)
    
    # Reaction term (Local potential drive)
    # Derivative f'(phi) = -r*phi + u*phi^3 => Reaction = -f' = r*phi - u*phi^3
    reaction = r * phi - u * phi**3
    
    # Update field
    phi_new = phi + dt * (kappa * lap + reaction)
    return phi_new

# ==========================================
# 4. Visualization Setup
# ==========================================
# Custom Colormap: Replicating the lecture's visual style
# -1 (Spin Down) -> Blue
#  0 (Interface) -> Green/Yellowish (Transition region)
# +1 (Spin Up)   -> Red
colors = [(0, 0, 1), (0.0, 0.8, 0.0), (1, 0, 0)]  # Blue -> Green -> Red
n_bins = 100
cmap_name = 'spin_decomposition_map'
cm = LinearSegmentedColormap.from_list(cmap_name, colors, N=n_bins)

fig, ax = plt.subplots(figsize=(6, 6))
# Set vmin/vmax slightly > 1 to avoid color saturation at stable points
im = ax.imshow(phi, cmap=cm, vmin=-1.2, vmax=1.2, interpolation='bilinear', origin='lower')
ax.set_title(f"Model A Dynamics (Step 0)")
ax.axis('off')

# Text for time step display
time_text = ax.text(0.05, 0.95, '', transform=ax.transAxes, color='white', fontsize=12)

def animate(frame_idx):
    global phi
    # Perform multiple physics steps per animation frame for speed
    steps_per_frame = 20
    for _ in range(steps_per_frame):
        phi = update_step(phi, dt, dx, kappa, r, u)
    
    im.set_array(phi)
    current_step = frame_idx * steps_per_frame
    time_text.set_text(f'Step: {current_step}')
    ax.set_title(f"Model A Dynamics (Step {current_step})")
    return [im, time_text]

# Create animation object
ani = animation.FuncAnimation(fig, animate, frames=total_steps//20, interval=30, blit=False)

# Save the animation as a video file
print("Saving simulation as video...")
ani.save('model_a_dynamics.mp4', writer='ffmpeg', fps=30, dpi=150)
print("Video saved as 'model_a_dynamics.mp4'.")

print("Starting simulation visualization...")
plt.show()

```


<video controls width="100%">
  <source src="../assets/images/model_a_dynamics.mp4" type="video/mp4">
  您的浏览器不支持视频标签。
</video>

这个动态视频展示了数值模拟的演化过程。整个区域呈现出均匀的绿色背景，这对应于 $\phi \approx 0$ 的值。这代表了高温下的**无序相**，此时系统尚未发生相分离，序参量在零附近只有微小的热涨落。随着模拟的进行（如后续动画所示），这个均匀的绿色区域将迅速分解为代表两个有序相的红色（$\phi \approx +1$）和蓝色（$\phi \approx -1$）斑块，并在其间形成清晰的界面。

## 5.3 模拟结果分析：三个动力学阶段

通过运行代码并观察演化过程，可以清晰地识别出相分离动力学的三个特征阶段：

![课堂PPT截图](../assets/images/09_008_10131412-2e53-482d-8576-c2d3008bfa32.jpg)

 Allen-Cahn 方程数值解的时间演化序列。左上：初始随机涨落；右上：Spinodal分解导致的早期斑图；左下：界面形成与畴壁粗化；右下：晚期大尺度畴的合并。

### 1. 早期阶段：失稳分解 (Spinodal Decomposition)

**现象**：初始的均匀绿色背景迅速变得“斑驳”。微小的涨落被迅速放大，场值 $\phi$ 局域地向 $\pm \sqrt{r/u}$（红/蓝）分化。

**机制**：这一阶段主要由反应项 $r\phi - u\phi^3$ 驱动。由于 $r>0$，原点 $\phi=0$ 是不稳定的（$f''(0)<0$），导致长波模式（$q \approx 0$）呈指数增长。系统在极短时间内建立了局域的有序，但整体仍呈现细碎的迷宫状结构。

### 2. 中期阶段：畴壁形成 (Domain Formation)

**现象**：场值迅速饱和在 $\pm 1$ 附近，红色区域和蓝色区域之间形成了清晰、锐利的边界。这些边界处 $\phi$ 必须经过 0，因此呈现出绿色的线条，即**界面 (Interface)** 或磁畴壁。

**特征**：此时系统的大部分能量都集中在这些界面上（梯度能密度高）。非线性项限制了 $\phi$ 的无限增长，使得界面宽度稳定在关联长度 $\xi$ 附近。

### 3. 晚期阶段：粗化 (Coarsening)

**现象**：迷宫状的斑图逐渐变“粗”。较小的磁畴（岛屿）收缩并消失，较大的磁畴吞并周围的小磁畴，弯曲的界面逐渐变直。

**机制**：这一阶段的演化极其缓慢，主要由扩散项 $\kappa \nabla^2 \phi$ 驱动。物理上，这是**表面张力**在起作用——系统通过减少总界面长度来降低总自由能。这直接预示了下一节的主题：**曲率驱动流**。特征尺度 $L(t)$ 随时间遵循幂律增长 $L(t) \sim t^{1/2}$，这是非守恒型动力学的标志性特征。

# 总结

这节课标志着这系列课程的进入到跨越尺度的理论构建。通过 Landau 理论，分析忽略了自旋的微观细节，仅利用对称性捕捉了相变的本质，实现了从微观到宏观的跨越；引入弛豫假设，将热力学泛函转化为 Model A 动力学方程，成功描述了非平衡态的时间演化，实现了从静态到动态的转变；利用线性稳定性分析解释了模式的起始（Spinodal 分解），并通过数值模拟展示了非线性的粗化与界面形成，实现了从线性到非线性的深入。Model A 现已成为描述自然界中“无守恒约束的有序化过程”的通用语言。

在数值模拟的晚期阶段，一个显著的几何效应浮现：界面总是试图“变直”或“收缩”。这蕴含了深刻的物理机制——**表面张力与能量最小化**。Ginzburg-Landau 自由能中的梯度项 $\frac{\kappa}{2}(\nabla \phi)^2$ 本质上体现了表面张力。在界面处，序参量 $\phi$ 的剧烈变化形成高能量密度的“墙”，导致总自由能正比于界面的总面积（或二维中的总长度）。根据弛豫动力学原理 $\frac{d\mathcal{F}}{dt} \le 0$，系统必须不断减小界面的总长度以降低能量。

这种几何效应预示了 Model A 在晚期阶段退化为界面动力学方程，即 **Allen-Cahn 定律**：界面的法向速度 $V$ 正比于其平均曲率 $H$：

$$
V = -\mu \kappa H
$$

其中负号意味着界面总是向曲率中心的反方向运动（即向内凹陷的一侧运动）。凸起的区域会被磨平，凹陷的区域会被填补，闭合的小圆环会以不断加速的速率收缩直至湮灭。这正是模拟中观察到的“粗化”现象的微观几何解释。

目前关于界面运动的分析主要基于定性类比（如肥皂泡）或数值观察。**下一讲 (Lecture 10)** 将引入理论物理的核心技巧——**奇异摄动理论 (Singular Perturbation Theory)** 。课程将从 Allen-Cahn 方程出发，通过多尺度展开 (Multiscale Expansion)，严格推导出界面运动方程。这将证明“曲率驱动流”不仅仅是一个直观的类比，而是 Model A 在尖锐界面极限下的严格数学结论，从而将反应-扩散系统与微分几何紧密联系起来，为理解生物膜动力学和晶体生长奠定基础。


